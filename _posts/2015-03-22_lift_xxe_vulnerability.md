title: Lift XML Vulnerability
author: David Pollak
tags: [x-dpp,security]

## A Serious Vulnerability

Security testing at a large [Lift](http://liftweb.net)-powered site revealed a serious XML-related
security vulnerability.

The core issue is that Lift prior to recently patched versions 2.5.2, 2.6.1, and 3.0-M4
are vulnerable to a [XML eXternal Entity](https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing)
attack. The attack allows access to the local filesystem via XML entities:

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
  <!DOCTYPE foo [
     <!ELEMENT foo ANY >
        <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo>
```

The root cause of the problem is that Lift uses Scala's `scala.xml.XML` library for
parsing and the default configuration of that library is insecure.

We reached out to the [Typesafe](http://typesafe.com) folks to let them know about
the vulnerability. They pointed us to how [Play!](https://www.playframework.com/) handles [XML-related issues](https://github.com/playframework/playframework/blob/master/framework/src/play/src/main/scala/play/api/Play.scala#L43-L48) as well
as an [open ticket](https://github.com/scala/scala-xml/issues/17) related
to `scala.xml`'s security. A shout-out to Typesafe for doing security right
and to being helpful to the Lift team.

We released Lift 2.5.2 and 2.6.1 earlier this week to fix the XXE issue, and
just released 2.5.3 and 2.6.2 that harden XML parsing further.
We suggest that Lift (or any) apps that use `scala.xml.XML` switch to using
`net.liftweb.util.Helpers.secureXML`, which has an identical API but is secured against
several common XML vulnerabilities.
